---
ms.assetid: 7a7ab95c-9cb3-4a7b-985a-3fc08334cf4f
title: Implémentation de modèles d’administration selon le principe des privilèges minimum
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.date: 08/09/2018
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adds
ms.openlocfilehash: c8655c7bac977bf94add1531d299e2fa17ef530d
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/08/2020
ms.locfileid: "80821242"
---
# <a name="implementing-least-privilege-administrative-models"></a>Implémentation de modèles d’administration selon le principe des privilèges minimum

>S’applique à : Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

L’extrait suivant est issu du [Guide de planification de la sécurité des comptes d’administrateur](https://technet.microsoft.com/library/cc162797.aspx), publié pour la première fois le 1er avril 1999 :

> «La plupart des cours et de la documentation relatifs à la sécurité discutent de l’implémentation d’un principe des privilèges minimum, mais les organisations les suivent rarement. Le principe est simple, et l’impact de l’application de celui-ci augmente considérablement votre sécurité et réduit vos risques. Le principe stipule que tous les utilisateurs doivent se connecter avec un compte d’utilisateur disposant des autorisations absolues minimales nécessaires pour terminer la tâche en cours et rien de plus. Cela offre une protection contre le code malveillant, entre autres attaques. Ce principe s’applique aux ordinateurs et aux utilisateurs de ces ordinateurs.   
> «Une des raisons pour lesquelles ce principe fonctionne bien, c’est qu’elle vous oblige à effectuer des recherches internes. Par exemple, vous devez déterminer les privilèges d’accès dont un ordinateur ou un utilisateur a vraiment besoin, puis les implémenter. Pour de nombreuses organisations, cette tâche peut initialement sembler un grand nombre de travaux. Toutefois, il s’agit d’une étape essentielle pour sécuriser correctement votre environnement réseau.
> «Vous devez accorder à tous les utilisateurs de l’administrateur de domaine leurs privilèges de domaine sous le concept des privilèges minimum. Par exemple, si un administrateur se connecte avec un compte privilégié et exécute par inadvertance un programme de virus, le virus dispose d’un accès administratif à l’ordinateur local et à l’ensemble du domaine. Si, à la place, l’administrateur avait ouvert une session avec un compte non privilégié (non administratif), l’étendue du virus est l’ordinateur local, car il s’exécute en tant qu’utilisateur de l’ordinateur local.
> «Dans un autre exemple, les comptes auxquels vous accordez des droits d’administrateur au niveau du domaine ne doivent pas disposer de droits élevés dans une autre forêt, même s’il existe une relation d’approbation entre les forêts. Cette tactique permet d’éviter les dommages répandus si une personne malveillante parvient à compromettre une forêt gérée. Les organisations doivent régulièrement auditer leur réseau pour se protéger contre les escalades de privilèges non autorisées.»  

L’extrait suivant est issu du [Kit de ressources de sécurité Microsoft Windows](https://www.microsoftpressstore.com/store/microsoft-windows-security-resource-kit-9780735621749), publié pour la première fois dans 2005 :  

> «Pensez toujours à la sécurité en termes d’octroi du moins de privilèges requis pour effectuer la tâche. Si une application ayant un trop grand nombre de privilèges doit être compromise, l’attaquant peut être en mesure d’étendre l’attaque au-delà de ce qu’elle pourrait faire si l’application avait le moins de privilèges possible. Par exemple, examinez les conséquences d’un administrateur réseau qui ouvre involontairement une pièce jointe de courrier électronique qui lance un virus. Si l’administrateur est connecté à l’aide du compte d’administrateur de domaine, le virus disposera des privilèges d’administrateur sur tous les ordinateurs du domaine et, par conséquent, un accès illimité à presque toutes les données sur le réseau. Si l’administrateur est connecté à l’aide d’un compte d’administrateur local, le virus disposera des privilèges d’administrateur sur l’ordinateur local et pourra ainsi accéder à toutes les données de l’ordinateur et installer des logiciels malveillants tels que le logiciel de journalisation des frappes de touches sur l’ordinateur. Si l’administrateur est connecté à l’aide d’un compte d’utilisateur normal, le virus n’aura accès qu’aux données de l’administrateur et ne pourra pas installer de logiciel malveillant. En utilisant les privilèges minimaux nécessaires pour lire les courriers électroniques, dans cet exemple, la portée potentielle de la compromission est très réduite.»  

## <a name="the-privilege-problem"></a>Le problème de privilège

Les principes décrits dans les extraits précédents n’ont pas changé, mais dans le cadre de l’évaluation des installations Active Directory, nous trouvons invariablement un nombre excessif de comptes disposant de droits et d’autorisations bien supérieurs à ceux requis pour effectuer les tâches quotidiennes. La taille de l’environnement affecte le nombre brut de comptes trop privilégiés, mais les répertoires proportionmidsized ne peuvent pas contenir des dizaines de comptes dans les groupes les plus privilégiés, tandis que les installations volumineuses peuvent avoir des centaines voire des milliers. À quelques exceptions près, quelle que soit la sophistication des compétences et de l’arsenal des attaquants, les attaquants suivent généralement le chemin le moins résistant. Elles augmentent la complexité de leurs outils et de leur approche uniquement si et quand des mécanismes plus simples échouent ou sont neutralisés par les défenseurs.  

Malheureusement, le chemin de la résistance la plus faible dans de nombreux environnements s’est avéré être l’utilisation abusive de comptes avec des privilèges étendus et approfondis. Des privilèges étendus sont des droits et des autorisations qui permettent à un compte d’effectuer des activités spécifiques dans une large section de l’environnement. par exemple, le personnel du support technique peut se voir accorder des autorisations qui lui permettent de réinitialiser les mots de passe de nombreux comptes d’utilisateur.  

Les privilèges approfondis sont des privilèges puissants qui sont appliqués à un segment étroit de l’alimentation, par exemple, en donnant aux ingénieurs des droits d’administrateur sur un serveur afin qu’ils puissent effectuer des réparations. Aucun privilège important ou privilège profond n’est nécessairement dangereux, mais quand un grand nombre de comptes dans le domaine bénéficient d’un privilège étendu et profond, si un seul des comptes est compromis, il peut être utilisé rapidement pour reconfigurer l’environnement à la fois, voire pour détruire des segments importants de l’infrastructure.  

Les attaques Pass-The-hash, qui sont un type d’attaque de vol d’informations d’identification, sont omniprésentes car les outils pour les exécuter sont librement disponibles et faciles à utiliser, et parce que de nombreux environnements sont vulnérables aux attaques. Les attaques Pass-The-hash, toutefois, ne sont pas le vrai problème. Le essentiel du problème est double :  

1. Il est généralement facile pour une personne malveillante d’obtenir un privilège profond sur un seul ordinateur, puis de propager ce privilège de manière large vers d’autres ordinateurs.  
2. Il y a généralement trop de comptes permanents avec des niveaux élevés de privilèges dans le paysage informatique.

Même si les attaques Pass-The-hash sont éliminées, les attaquants utilisent simplement des tactiques différentes, pas une stratégie différente. Au lieu de mettre en place des logiciels malveillants contenant des outils de vol d’informations d’identification, ceux-ci peuvent planter les programmes malveillants qui consignent les séquences de touches ou tirer parti d’un nombre quelconque d’autres approches pour capturer les informations d’identification puissantes dans l’environnement. Quelles que soient les tactiques, les cibles restent les mêmes : les comptes avec des privilèges étendus et approfondis.  

L’octroi d’un privilège excessif est introuvable dans les Active Directory dans les environnements compromis. Lorsqu’une organisation a développé l’habitude d’octroyer plus de privilèges que nécessaire, elle se trouve généralement dans toute l’infrastructure, comme indiqué dans les sections suivantes.  

## <a name="in-active-directory"></a>Dans Active Directory

Dans Active Directory, il est courant de constater que les groupes EA, DA et BA contiennent un nombre excessif de comptes. Le plus souvent, le groupe EA d’une organisation contient le moins de membres, les groupes DA contiennent généralement un multiplicateur du nombre d’utilisateurs dans le groupe EA et les groupes Administrateurs contiennent généralement plus de membres que les populations des autres groupes combinés. Cela est souvent dû au fait que les administrateurs sont « moins privilégiés » que DAs ou EAs. Alors que les droits et autorisations accordés à chacun de ces groupes diffèrent, ils doivent être considérés comme des groupes aussi puissants, car un membre de l’un peut se faire être membre des deux autres.  

## <a name="on-member-servers"></a>Sur les serveurs membres

Lorsque nous récupérons l’appartenance de groupes d’administrateurs locaux sur des serveurs membres dans de nombreux environnements, nous trouvons l’appartenance entre quelques comptes locaux et de domaine, et des dizaines de groupes imbriqués qui, lorsqu’ils sont étendus, révèlent des centaines, voire des milliers, de comptes dotés de privilèges d’administrateur local sur les serveurs. Dans de nombreux cas, les groupes de domaine avec des appartenances volumineuses sont imbriqués dans les groupes d’administrateurs locaux des serveurs membres, sans tenir compte du fait que tout utilisateur qui peut modifier les appartenances à ces groupes dans le domaine peut bénéficier d’un contrôle administratif sur tous les systèmes sur lesquels le groupe a été imbriqué dans un groupe Administrateurs local.  

## <a name="on-workstations"></a>Sur les stations de travail

Bien que les stations de travail aient généralement beaucoup moins de membres dans leurs groupes d’administrateurs locaux que les serveurs membres, dans de nombreux environnements, les utilisateurs bénéficient d’une appartenance au groupe Administrateurs local sur leurs ordinateurs personnels. Lorsque cela se produit, même si le contrôle de compte d’utilisateur est activé, ces utilisateurs présentent un risque élevé pour l’intégrité de leurs stations de travail.  

> [!IMPORTANT]  
> Vous devez réfléchir soigneusement si les utilisateurs nécessitent des droits d’administration sur leurs postes de travail et, le cas échéant, une meilleure approche consiste à créer un compte local distinct sur l’ordinateur membre du groupe administrateurs. Lorsque les utilisateurs requièrent une élévation, ils peuvent présenter les informations d’identification de ce compte local pour l’élévation, mais comme le compte est local, il ne peut pas être utilisé pour compromettre d’autres ordinateurs ou accéder aux ressources du domaine. Toutefois, comme pour tous les comptes locaux, les informations d’identification du compte privilégié local doivent être uniques. Si vous créez un compte local avec les mêmes informations d’identification sur plusieurs stations de travail, vous exposez les ordinateurs pour les attaques de réussite.  

## <a name="in-applications"></a>Dans les applications

Dans les attaques où la cible est la propriété intellectuelle d’une organisation, les comptes qui ont reçu des privilèges puissants au sein des applications peuvent être ciblés pour permettre l’exfiltration des données. Bien que les comptes qui ont accès à des données sensibles aient peut-être accordé des privilèges élevés dans le domaine ou le système d’exploitation, les comptes qui peuvent manipuler la configuration d’une application ou l’accès aux informations fournies par l’application présentent un risque.  

## <a name="in-data-repositories"></a>Dans les référentiels de données

Comme c’est le cas avec d’autres cibles, les attaquants qui cherchent à accéder à la propriété intellectuelle sous la forme de documents et d’autres fichiers peuvent cibler les comptes qui contrôlent l’accès aux magasins de fichiers, les comptes qui ont un accès direct aux fichiers, ou même les groupes ou les rôles qui ont accès aux fichiers. Par exemple, si un serveur de fichiers est utilisé pour stocker des documents de contrat et que l’accès est accordé aux documents par l’utilisation d’un groupe de Active Directory, une personne malveillante qui peut modifier l’appartenance du groupe peut ajouter des comptes compromis au groupe et accéder aux documents de contrat. Dans les cas où l’accès aux documents est fourni par des applications telles que SharePoint, les attaquants peuvent cibler les applications comme décrit précédemment.  

## <a name="reducing-privilege"></a>Réduction des privilèges

Plus la taille d’un environnement est importante et complexe, plus il est difficile à gérer et à sécuriser. Dans les petites organisations, l’examen et la réduction des privilèges peuvent être une proposition relativement simple, mais chaque serveur, station de travail, compte d’utilisateur et application en cours d’utilisation dans une organisation ajoute un autre objet qui doit être sécurisé. Étant donné qu’il peut être difficile, voire impossible, de sécuriser correctement tous les aspects de l’infrastructure informatique d’une organisation, vous devez d’abord concentrer les efforts sur les comptes dont le privilège crée le plus grand risque, qui sont généralement les comptes et les groupes privilégiés intégrés dans Active Directory, et les comptes locaux privilégiés sur les stations de travail et les serveurs membres.  

### <a name="securing-local-administrator-accounts-on-workstations-and-member-servers"></a>Sécurisation des comptes d’administrateur local sur les stations de travail et les serveurs membres

Bien que ce document se concentre sur la sécurisation des Active Directory, comme nous l’avons vu précédemment, la plupart des attaques contre le répertoire commencent par des attaques sur des ordinateurs hôtes individuels. Il n’est pas possible de fournir des instructions complètes pour la sécurisation des groupes locaux sur les systèmes membres, mais les recommandations suivantes peuvent être utilisées pour vous aider à sécuriser les comptes d’administrateur local sur les stations de travail et les serveurs membres.  

#### <a name="securing-local-administrator-accounts"></a>Sécurisation des comptes d’administrateur local

Sur toutes les versions de Windows actuellement en support standard, le compte d’administrateur local est désactivé par défaut, ce qui rend le compte inutilisable pour les attaques Pass-The-hash et autres vols d’informations d’identification. Toutefois, dans les domaines contenant des systèmes d’exploitation hérités ou dans lesquels les comptes d’administrateur local ont été activés, ces comptes peuvent être utilisés comme décrit précédemment pour propager la compromission entre les serveurs membres et les stations de travail. Pour cette raison, les contrôles suivants sont recommandés pour tous les comptes d’administrateur local sur les systèmes joints à un domaine.  

Des instructions détaillées pour l’implémentation de ces contrôles sont fournies dans l' [annexe H : sécurisation des comptes et des groupes d’administrateurs locaux](../../../ad-ds/plan/security-best-practices/Appendix-H--Securing-Local-Administrator-Accounts-and-Groups.md). Toutefois, avant d’implémenter ces paramètres, assurez-vous que les comptes d’administrateur local ne sont pas actuellement utilisés dans l’environnement pour exécuter des services sur des ordinateurs ou exécuter d’autres activités pour lesquelles ces comptes ne doivent pas être utilisés. Testez ces paramètres minutieusement avant de les implémenter dans un environnement de production.  

#### <a name="controls-for-local-administrator-accounts"></a>Contrôles pour les comptes d’administrateur local

Les comptes d’administrateur intégrés ne doivent jamais être utilisés comme comptes de service sur les serveurs membres, ni être utilisés pour ouvrir une session sur des ordinateurs locaux (sauf en mode sans échec, ce qui est autorisé même si le compte est désactivé). L’objectif de l’implémentation des paramètres décrits ici consiste à empêcher l’utilisation du compte d’administrateur local de chaque ordinateur, sauf si les contrôles de protection sont inversés en premier. En implémentant ces contrôles et en surveillant les comptes d’administrateur pour les modifications, vous pouvez réduire considérablement la probabilité de réussite d’une attaque ciblant les comptes d’administrateur local.  

##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-joined-systems"></a>Configuration des objets de stratégie de groupe pour restreindre les comptes d’administrateur sur les systèmes joints à un domaine

Dans un ou plusieurs objets de stratégie de groupe que vous créez et liez à des unités d’organisation de station de travail et de serveur membre dans chaque domaine, ajoutez le compte d’administrateur aux droits d’utilisateur suivants dans la stratégie d' **autorisation \ paramètres système**\ stratégies d’autorisation :  

- Refuser l'accès à un ordinateur à partir du réseau
- Refuser l'ouverture de session en tant que tâche
- Refuser l'ouverture de session en tant que service
- Interdire l’ouverture de session par les services Bureau à distance

Lorsque vous ajoutez des comptes d’administrateur à ces droits d’utilisateur, spécifiez si vous ajoutez le compte d’administrateur local ou le compte d’administrateur du domaine de la façon dont vous étiquetez le compte. Par exemple, pour ajouter le compte administrateur du domaine NWTRADERS à ces droits Deny, vous devez taper le compte **NWTRADERS\Administrateur**ou accéder au compte administrateur du domaine nwtraders. Pour vous assurer que vous limitez le compte d’administrateur local, tapez **administrateur** dans ces paramètres de droits d’utilisateur dans l’éditeur d’objets stratégie de groupe.  

> [!NOTE]  
> Même si les comptes d’administrateur local sont renommés, les stratégies s’appliquent toujours.  

Ces paramètres permettent de s’assurer que le compte d’administrateur d’un ordinateur ne peut pas être utilisé pour se connecter aux autres ordinateurs, même s’il est activé par inadvertance ou par malveillance. Les ouvertures de session locales utilisant le compte d’administrateur local ne peuvent pas être complètement désactivées, et vous ne devez pas essayer de le faire, car le compte d’administrateur local d’un ordinateur est conçu pour être utilisé dans des scénarios de récupération d’urgence.  

Si un serveur membre ou une station de travail est disjoint du domaine sans aucun autre compte local disposant de privilèges d’administration, l’ordinateur peut être démarré en mode sans échec, le compte administrateur peut être activé et le compte peut ensuite être utilisé pour effectuer des réparations sur l’ordinateur. Une fois les réparations effectuées, le compte administrateur doit à nouveau être désactivé.  

### <a name="securing-local-privileged-accounts-and-groups-in-active-directory"></a>Sécurisation des comptes et des groupes à privilèges locaux dans Active Directory

*Numéro de loi six : un ordinateur est aussi sécurisé que l’administrateur est digne de confiance.* - [dix lois immuables de sécurité (Version 2,0)](https://technet.microsoft.com/security/hh278941.aspx)  

Les informations fournies ici sont destinées à fournir des instructions générales pour la sécurisation des comptes et groupes intégrés avec privilèges les plus élevés dans Active Directory. Des instructions pas à pas détaillées sont également fournies dans l' [annexe D : sécurisation des comptes administrateur intégrés dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md), [annexe E : sécurisation des groupes Administrateurs de l’entreprise dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-E--Securing-Enterprise-Admins-Groups-in-Active-Directory.md), [annexe F : sécurisation des groupes admins du domaine dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md)et dans [l’annexe G : sécurisation des groupes Administrateurs dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md).  

Avant d’implémenter l’un de ces paramètres, vous devez également tester minutieusement tous les paramètres pour déterminer s’ils sont appropriés pour votre environnement. Toutes les organisations ne peuvent pas implémenter ces paramètres.  

#### <a name="securing-built-in-administrator-accounts-in-active-directory"></a>Sécurisation des comptes administrateur intégrés dans Active Directory

Dans chaque domaine de Active Directory, un compte d’administrateur est créé dans le cadre de la création du domaine. Ce compte est par défaut membre des groupes Admins du domaine et administrateur dans le domaine, et si le domaine est le domaine racine de la forêt, le compte est également membre du groupe administrateurs de l’entreprise. L’utilisation du compte d’administrateur local d’un domaine doit être réservée pour les activités de génération initiales et, éventuellement, les scénarios de récupération d’urgence. Pour vous assurer qu’un compte administrateur intégré peut être utilisé pour effectuer des réparations dans le cas où aucun autre compte ne peut être utilisé, vous ne devez pas modifier l’appartenance par défaut du compte administrateur dans n’importe quel domaine de la forêt. Au lieu de cela, vous devez suivre les instructions pour sécuriser le compte administrateur dans chaque domaine de la forêt. Des instructions détaillées pour l’implémentation de ces contrôles sont fournies dans l' [annexe D : sécurisation des comptes administrateur intégrés dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  

#### <a name="controls-for-built-in-administrator-accounts"></a>Contrôles pour les comptes d’administrateur intégrés

L’objectif de l’implémentation des paramètres décrits ici consiste à empêcher l’utilisation du compte d’administrateur de chaque domaine (et non d’un groupe), à moins qu’un certain nombre de contrôles ne soient inversés. En implémentant ces contrôles et en surveillant les comptes d’administrateur pour les modifications, vous pouvez réduire de manière significative la probabilité d’une attaque réussie en tirant parti du compte administrateur d’un domaine. Pour le compte administrateur dans chaque domaine de votre forêt, vous devez configurer les paramètres suivants.  

##### <a name="enable-the-account-is-sensitive-and-cannot-be-delegated-flag-on-the-account"></a>Activer l’indicateur « le compte est sensible et ne peut pas être délégué » sur le compte

Par défaut, tous les comptes de Active Directory peuvent être délégués. La délégation permet à un ordinateur ou à un service de présenter les informations d’identification d’un compte qui s’est authentifié auprès de l’ordinateur ou du service sur d’autres ordinateurs pour obtenir des services au nom du compte. Lorsque vous activez le **compte est sensible et ne peut pas être** un attribut délégué sur un compte basé sur un domaine, les informations d’identification du compte ne peuvent pas être présentées à d’autres ordinateurs ou services sur le réseau, ce qui limite les attaques qui exploitent la délégation pour utiliser les informations d’identification du compte sur d’autres systèmes.  

##### <a name="enable-the-smart-card-is-required-for-interactive-logon-flag-on-the-account"></a>Activer l’indicateur « la carte à puce est nécessaire pour ouvrir une session interactive » sur le compte

Lorsque vous activez la **carte à puce requise pour** l’attribut de connexion interactive sur un compte, Windows réinitialise le mot de passe du compte à une valeur aléatoire de 120 caractères. En définissant cet indicateur sur les comptes d’administrateur intégrés, vous vous assurez que le mot de passe du compte est non seulement long et complexe, mais qu’il n’est pas connu de l’utilisateur. Il n’est pas techniquement nécessaire de créer des cartes à puce pour les comptes avant d’activer cet attribut, mais si possible, les cartes à puce doivent être créées pour chaque compte d’administrateur avant la configuration des restrictions de compte et les cartes à puce doivent être stockées dans des emplacements sécurisés.  

Bien que la définition **de la carte à puce soit requise pour l’indicateur de connexion interactive** réinitialise le mot de passe du compte, elle n’empêche pas un utilisateur disposant des droits de réinitialiser le mot de passe du compte de la définition du compte sur une valeur connue et d’utiliser le nom du compte et le nouveau mot de passe pour accéder aux ressources du réseau. Pour cette raison, vous devez implémenter les contrôles supplémentaires suivants sur le compte.  

##### <a name="configuring-gpos-to-restrict-domains-administrator-accounts-on-domain-joined-systems"></a>Configuration des objets de stratégie de groupe pour restreindre les comptes administrateur de domaines sur les systèmes joints à un domaine

Bien que la désactivation du compte administrateur dans un domaine rende le compte inutilisable, vous devez implémenter des restrictions supplémentaires sur le compte si le compte est activé par inadvertance ou par malveillance. Bien que ces contrôles puissent finalement être inversés par le compte d’administrateur, l’objectif est de créer des contrôles qui ralentissent la progression d’un attaquant et limitent les dommages que le compte peut infliger.  

Dans un ou plusieurs objets de stratégie de groupe que vous créez et liez à des UO de station de travail et de serveur membre dans chaque domaine, ajoutez le compte d’administrateur de chaque domaine aux droits d’utilisateur suivants dans la stratégie d’autorisation \ paramètres d’utilisateur \ **stratégies d’autorisation \ stratégies d’autorisation**:  

- Refuser l'accès à un ordinateur à partir du réseau  
- Refuser l'ouverture de session en tant que tâche  
- Refuser l'ouverture de session en tant que service  
- Interdire l’ouverture de session par les services Bureau à distance  

> [!NOTE]  
> Lorsque vous ajoutez des comptes d’administrateur local à ce paramètre, vous devez spécifier si vous configurez des comptes d’administrateur local ou des comptes d’administrateur de domaine. Par exemple, pour ajouter le compte d’administrateur local du domaine NWTRADERS à ces droits Deny, vous devez taper le compte en tant que **NWTRADERS\Administrateur**ou accéder au compte d’administrateur local pour le domaine nwtraders. Si vous tapez **administrateur** dans ces paramètres de droits d’utilisateur dans l’éditeur d’objets stratégie de groupe, vous limitez le compte d’administrateur local sur chaque ordinateur auquel l’objet de stratégie de groupe est appliqué.  
>
> Nous vous recommandons de restreindre les comptes d’administrateur local sur les serveurs et stations de travail membres de la même manière que les comptes d’administrateur basés sur un domaine. Par conséquent, vous devez généralement ajouter le compte administrateur pour chaque domaine de la forêt et le compte administrateur pour les ordinateurs locaux à ces paramètres de droits d’utilisateur. 

##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-controllers"></a>Configuration des objets de stratégie de groupe pour restreindre les comptes administrateur sur les contrôleurs de domaine

Dans chaque domaine de la forêt, la stratégie des contrôleurs de domaine par défaut ou une stratégie liée à l’unité d’organisation des contrôleurs de domaine doit être modifiée pour ajouter le compte d’administrateur de chaque domaine aux droits d’utilisateur suivants dans la stratégie d' **autorisation \ paramètres système**\ stratégies d’autorisation \ stratégies d’autorisation :  

- Refuser l'accès à un ordinateur à partir du réseau  
- Refuser l'ouverture de session en tant que tâche  
- Refuser l'ouverture de session en tant que service  
- Interdire l’ouverture de session par les services Bureau à distance  

> [!NOTE]  
> Ces paramètres garantissent que le compte d’administrateur local ne peut pas être utilisé pour se connecter à un contrôleur de domaine, même si le compte, s’il est activé, peut ouvrir une session localement sur les contrôleurs de domaine. Étant donné que ce compte ne doit être activé et utilisé que dans les scénarios de récupération d’urgence, il est prévu que l’accès physique à au moins un contrôleur de domaine soit disponible, ou que d’autres comptes disposant des autorisations d’accès à distance des contrôleurs de domaine puissent être utilisés.  

##### <a name="configure-auditing-of-built-in-administrator-accounts"></a>Configurer l’audit des comptes administrateur intégrés

Une fois que vous avez sécurisé le compte administrateur d’un domaine et que vous l’avez désactivé, vous devez configurer l’audit pour surveiller les modifications apportées au compte. Si le compte est activé, son mot de passe est réinitialisé, ou toute autre modification apportée au compte, des alertes doivent être envoyées aux utilisateurs ou équipes responsables de l’administration de AD DS, en plus des équipes de réponse aux incidents de votre organisation.  

### <a name="securing-administrators-domain-admins-and-enterprise-admins-groups"></a>Sécurisation des administrateurs, des administrateurs de domaine et des groupes Administrateurs de l’entreprise

#### <a name="securing-enterprise-admin-groups"></a>Sécurisation des groupes d’administration d’entreprise

Le groupe administrateurs de l’entreprise, qui est hébergé dans le domaine racine de la forêt, ne doit pas contenir d’utilisateurs au quotidien, à l’exception possible du compte d’administrateur local du domaine, à condition qu’il soit sécurisé comme décrit précédemment et dans l' [annexe D : sécurisation des comptes administrateur intégrés dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  

Lorsque l’accès EA est requis, les utilisateurs dont les comptes requièrent des droits et autorisations EA doivent être placés temporairement dans le groupe administrateurs de l’entreprise. Bien que les utilisateurs utilisent les comptes dotés de privilèges élevés, leurs activités doivent être auditées et de préférence exécutées avec un utilisateur qui effectue les modifications et un autre utilisateur observe les modifications afin de réduire la probabilité d’une mauvaise utilisation ou d’une mauvaise configuration. Une fois les activités terminées, les comptes doivent être supprimés du groupe EA. Pour ce faire, vous pouvez utiliser les procédures manuelles et les processus documentés, les logiciels tiers de gestion des identités/accès (PIM/PAM) ou une combinaison des deux. Les instructions relatives à la création de comptes qui peuvent être utilisés pour contrôler l’appartenance à des groupes privilégiés dans Active Directory sont fournies dans des [comptes attrayants pour le vol d’informations d’identification](../../../ad-ds/plan/security-best-practices/Attractive-Accounts-for-Credential-Theft.md) et des instructions détaillées sont fournies dans [l’annexe I : création de comptes de gestion pour les comptes et les groupes protégés dans Active Directory](../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md).  

Les administrateurs de l’entreprise sont, par défaut, les membres du groupe Administrateurs intégré dans chaque domaine de la forêt. La suppression du groupe administrateurs de l’entreprise des groupes Administrateurs dans chaque domaine est une modification inappropriée, car dans le cas d’un scénario de récupération d’urgence de forêt, les droits EA seront probablement requis. Si le groupe administrateurs de l’entreprise a été supprimé des groupes Administrateurs dans une forêt, il doit être ajouté au groupe administrateurs dans chaque domaine et les contrôles supplémentaires suivants doivent être implémentés :  

- Comme décrit précédemment, le groupe administrateurs de l’entreprise ne doit pas contenir d’utilisateurs au quotidien, à l’exception possible du compte administrateur du domaine racine de la forêt, qui doit être sécurisé comme décrit dans l' [annexe D : sécurisation des comptes administrateur intégrés dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  
- Dans les objets de stratégie de groupe liés à des unités d’organisation contenant des serveurs membres et des stations de travail dans chaque domaine, le groupe EA doit être ajouté aux droits d’utilisateur suivants :  
   - Refuser l'accès à un ordinateur à partir du réseau  
   - Refuser l'ouverture de session en tant que tâche  
   - Refuser l'ouverture de session en tant que service  
   - Interdire l'ouverture d'une session locale  
   - Interdire l’ouverture de session via Services Bureau à distance.  

Cela empêchera les membres du groupe EA de se connecter aux serveurs et stations de travail membres. Si les serveurs de saut sont utilisés pour administrer des contrôleurs de domaine et des Active Directory, assurez-vous que les serveurs de saut se trouvent dans une UO à laquelle les objets de stratégie de groupe restrictifs ne sont pas liés.  

- L’audit doit être configuré pour envoyer des alertes si des modifications sont apportées aux propriétés ou à l’appartenance au groupe EA. Ces alertes doivent être envoyées au minimum aux utilisateurs ou équipes responsables de la Active Directory de l’administration et de la réponse aux incidents. Vous devez également définir des processus et des procédures pour le remplissage temporaire du groupe EA, y compris des procédures de notification lorsque la population légitime du groupe est exécutée.  
  
#### <a name="securing-domain-admins-groups"></a>Sécurisation des groupes Admins du domaine

Comme c’est le cas avec le groupe administrateurs de l’entreprise, l’appartenance aux groupes Admins du domaine doit être obligatoire uniquement dans les scénarios de génération ou de récupération d’urgence. Il ne doit y avoir aucun compte d’utilisateur quotidien dans le groupe DA, à l’exception du compte d’administrateur local pour le domaine, s’il a été sécurisé, comme décrit dans l' [annexe D : sécurisation des comptes administrateur intégrés dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  
  
Lorsque l’accès à la DA est requis, les comptes qui ont besoin de ce niveau d’accès doivent être placés temporairement dans le groupe DA pour le domaine en question. Bien que les utilisateurs utilisent les comptes dotés de privilèges élevés, les activités doivent être auditées et de préférence exécutées avec un utilisateur qui effectue les modifications et un autre utilisateur observe les modifications afin de réduire la probabilité d’une mauvaise utilisation ou d’une mauvaise configuration. Une fois les activités terminées, les comptes doivent être supprimés du groupe Admins du domaine. Cela peut être accompli via des procédures manuelles et des processus documentés, via un logiciel tiers de gestion des identités/accès (PIM/Access) ou une combinaison des deux. Les instructions relatives à la création de comptes qui peuvent être utilisés pour contrôler l’appartenance à des groupes privilégiés dans Active Directory sont fournies dans [l’annexe I : création de comptes de gestion pour les comptes et les groupes protégés dans Active Directory](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md).  
  
Les administrateurs de domaine sont, par défaut, membres des groupes Administrateurs locaux sur tous les serveurs membres et stations de travail dans leurs domaines respectifs. Cette imbrication par défaut ne doit pas être modifiée, car elle affecte la prise en charge et les options de récupération d’urgence. Si des groupes Admins du domaine ont été supprimés des groupes Administrateurs locaux sur les serveurs membres, ils doivent être ajoutés au groupe Administrateurs sur chaque serveur membre et chaque station de travail dans le domaine via des paramètres de groupe restreints dans les objets de stratégie de groupe liés. Les contrôles généraux suivants, décrits en détail dans l' [annexe F : sécurisation des groupes Admins du domaine dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md) doivent également être implémentés.  

Pour le groupe Admins du domaine dans chaque domaine de la forêt :  

1. Supprimez tous les membres du groupe DA, à l’exception du compte administrateur intégré pour le domaine, à condition qu’il ait été sécurisé, comme décrit dans l' [annexe D : sécurisation des comptes administrateur intégrés dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  
2. Dans les objets de stratégie de groupe liés à des unités d’organisation contenant des serveurs membres et des stations de travail dans chaque domaine, le groupe DA doit être ajouté aux droits d’utilisateur suivants :  
   - Refuser l'accès à un ordinateur à partir du réseau  
   - Refuser l'ouverture de session en tant que tâche  
   - Refuser l'ouverture de session en tant que service  
   - Interdire l'ouverture d'une session locale  
   - Interdire l’ouverture de session par les services Bureau à distance  
  
   Cela empêchera les membres du groupe DA de se connecter aux serveurs et stations de travail membres. Si les serveurs de saut sont utilisés pour administrer des contrôleurs de domaine et des Active Directory, assurez-vous que les serveurs de saut se trouvent dans une UO à laquelle les objets de stratégie de groupe restrictifs ne sont pas liés.  

3. L’audit doit être configuré pour envoyer des alertes si des modifications sont apportées aux propriétés ou à l’appartenance au groupe DA. Ces alertes doivent être envoyées au minimum aux utilisateurs ou équipes responsables de la AD DS de l’administration et de la réponse aux incidents. Vous devez également définir des processus et des procédures pour le remplissage temporaire du groupe DA, y compris des procédures de notification lorsque la population légitime du groupe est exécutée.  

#### <a name="securing-administrators-groups-in-active-directory"></a>Sécurisation des groupes d’administrateurs dans Active Directory

Comme c’est le cas avec les groupes EA et DA, l’appartenance au groupe Administrateurs (BA) doit être requise uniquement dans les scénarios de génération ou de récupération d’urgence. Il ne doit y avoir aucun compte d’utilisateur quotidien dans le groupe administrateurs, à l’exception du compte d’administrateur local pour le domaine, s’il a été sécurisé, comme décrit dans l' [annexe D : sécurisation des comptes administrateur intégrés dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  

Lorsque l’accès aux administrateurs est requis, les comptes qui ont besoin de ce niveau d’accès doivent être placés temporairement dans le groupe administrateurs du domaine en question. Bien que les utilisateurs utilisent les comptes dotés de privilèges élevés, les activités doivent être auditées et, de préférence, effectuées avec un utilisateur qui effectue les modifications et un autre utilisateur observe les modifications pour réduire la probabilité d’une mauvaise utilisation ou d’une mauvaise configuration. Une fois les activités terminées, les comptes doivent être supprimés immédiatement du groupe administrateurs. Cela peut être accompli via des procédures manuelles et des processus documentés, via un logiciel tiers de gestion des identités/accès (PIM/Access) ou une combinaison des deux.  

Les administrateurs sont, par défaut, les propriétaires de la plupart des objets AD DS dans leurs domaines respectifs. L’appartenance à ce groupe peut être nécessaire dans les scénarios de génération et de récupération d’urgence dans lesquels la propriété ou la possibilité de prendre possession d’objets est requise. En outre, les DAs et EAs héritent d’un certain nombre de leurs droits et autorisations en raison de leur appartenance par défaut au groupe administrateurs. L’imbrication de groupe par défaut pour les groupes privilégiés dans Active Directory ne doit pas être modifiée, et chaque groupe administrateurs de domaine doit être sécurisé comme décrit dans [annexe G : sécurisation des groupes d’administrateurs dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md)et dans les instructions générales ci-dessous.  

1. Supprimez tous les membres du groupe administrateurs, avec l’exception possible du compte d’administrateur local pour le domaine, à condition qu’il ait été sécurisé, comme décrit dans l' [annexe D : sécurisation des comptes administrateur intégrés dans Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  
2. Les membres du groupe administrateurs du domaine ne doivent jamais avoir à se connecter aux serveurs membres ou aux stations de travail. Dans un ou plusieurs objets de stratégie de groupe liés à des UO de station de travail et de serveur membre dans chaque domaine, le groupe administrateurs doit être ajouté aux droits d’utilisateur suivants :  
   - Refuser l'accès à un ordinateur à partir du réseau  
   - Interdire l’ouverture de session en tant que tâche,  
   - Refuser l'ouverture de session en tant que service  
   - Cela empêchera les membres du groupe administrateurs d’être utilisés pour ouvrir une session ou se connecter à des serveurs ou des stations de travail membres (à moins que plusieurs contrôles ne soient d’abord démunis), et que leurs informations d’identification puissent être mises en cache et donc compromises. Un compte privilégié ne doit jamais être utilisé pour se connecter à un système moins privilégié et l’application de ces contrôles offre une protection contre un certain nombre d’attaques.  

3. Au niveau de l’unité d’organisation contrôleurs de domaine dans chaque domaine de la forêt, le groupe administrateurs doit disposer des droits d’utilisateur suivants (s’ils ne disposent pas déjà de ces droits), ce qui permet aux membres du groupe administrateurs d’exécuter les fonctions nécessaires à un scénario de récupération d’urgence à l’ensemble de la forêt :  
   - Accéder à cet ordinateur à partir du réseau  
   - Permettre l'ouverture d'une session locale  
   - Autoriser l’ouverture de session par les services Bureau à distance  

4. L’audit doit être configuré pour envoyer des alertes si des modifications sont apportées aux propriétés ou à l’appartenance au groupe administrateurs. Ces alertes doivent être envoyées au minimum aux membres de l’équipe responsable de l’administration de AD DS. Les alertes doivent également être envoyées aux membres de l’équipe de sécurité, et des procédures doivent être définies pour modifier l’appartenance du groupe administrateurs. Plus précisément, ces processus doivent inclure une procédure par laquelle l’équipe de sécurité est avertie lorsque le groupe administrateurs sera modifié. ainsi, lorsque des alertes sont envoyées, elles sont attendues et aucune alarme n’est déclenchée. En outre, les processus pour notifier l’équipe de sécurité lorsque l’utilisation du groupe Administrateurs est terminée et que les comptes utilisés ont été supprimés du groupe doivent être implémentés.  

> [!NOTE]  
> Lorsque vous implémentez des restrictions sur le groupe administrateurs dans les objets de stratégie de groupe, Windows applique les paramètres aux membres du groupe Administrateurs local d’un ordinateur en plus du groupe administrateurs du domaine. Par conséquent, vous devez être prudent lors de l’implémentation de restrictions sur le groupe administrateurs. Bien qu’il soit recommandé d’interdire les ouvertures de session réseau, par lot et de service pour les membres du groupe administrateurs, chaque fois qu’il est possible de les implémenter, ne limitez pas les ouvertures de session locales ou les ouvertures de session via Services Bureau à distance. Le blocage de ces types d’ouverture de session peut bloquer l’administration légitime d’un ordinateur par les membres du groupe Administrateurs local. La capture d’écran suivante montre les paramètres de configuration qui bloquent la mauvaise utilisation des comptes d’administrateur de domaine et locaux intégrés, en plus de la mauvaise utilisation des groupes d’administrateurs de domaine ou locaux intégrés. Notez que le droit d’utilisateur **interdire l’ouverture de session via services Bureau à distance** n’inclut pas le groupe administrateurs, car son inclusion dans ce paramètre bloque également ces connexions pour les comptes qui sont membres du groupe administrateurs de l’ordinateur local. Si les services sur les ordinateurs sont configurés pour s’exécuter dans le contexte de l’un des groupes privilégiés décrits dans cette section, l’implémentation de ces paramètres peut entraîner l’échec des services et des applications. Par conséquent, comme pour toutes les recommandations de cette section, vous devez tester minutieusement les paramètres de mise en application dans votre environnement.  
>
> ![modèles d’administration des privilèges minimum](media/Implementing-Least-Privilege-Administrative-Models/SAD_3.gif)  

### <a name="role-based-access-controls-rbac-for-active-directory"></a>Contrôles d’accès en fonction du rôle (RBAC) pour Active Directory

En règle générale, les contrôles d’accès en fonction du rôle (RBAC) sont un mécanisme permettant de regrouper les utilisateurs et de fournir un accès aux ressources en fonction des règles d’entreprise. Dans le cas de Active Directory, l’implémentation de RBAC pour AD DS est le processus de création de rôles auxquels les droits et autorisations sont délégués pour permettre aux membres du rôle d’effectuer des tâches d’administration quotidiennes sans leur accorder un privilège excessif. RBAC pour Active Directory peut être conçu et implémenté par le biais d’interfaces et d’outils natifs, en tirant parti des logiciels que vous possédez peut-être déjà, en achetant des produits tiers ou en combinant n’importe quelle combinaison de ces approches. Cette section ne fournit pas d’instructions pas à pas pour implémenter RBAC pour Active Directory, mais aborde les facteurs à prendre en compte lors du choix d’une approche d’implémentation de RBAC dans vos installations AD DS.  

#### <a name="native-approaches-to-rbac-for-active-directory"></a>Approches natives du RBAC pour Active Directory

Dans l’implémentation RBAC la plus simple, vous pouvez implémenter des rôles en tant que groupes de AD DS et déléguer des droits et des autorisations aux groupes qui leur permettent d’effectuer une administration quotidienne au sein de l’étendue désignée du rôle.  

Dans certains cas, les groupes de sécurité existants dans Active Directory peuvent être utilisés pour accorder des droits et des autorisations appropriés à une fonction de travail. Par exemple, si des employés spécifiques de votre service informatique sont responsables de la gestion et de la maintenance des enregistrements et des zones DNS, la délégation de ces responsabilités peut être aussi simple que la création d’un compte pour chaque administrateur DNS et son ajout au groupe administrateurs DNS dans Active Directory. Contrairement aux groupes dotés de privilèges plus élevés, le groupe administrateurs DNS a peu de droits sur Active Directory, bien que les membres de ce groupe disposent d’autorisations déléguées qui leur permettent d’administrer le DNS et qui sont toujours sujettes à la compromission et que l’abus puisse entraîner une élévation de privilèges.

Dans d’autres cas, vous devrez peut-être créer des groupes de sécurité et déléguer des droits et des autorisations aux objets Active Directory, aux objets du système de fichiers et aux objets du Registre pour permettre aux membres des groupes d’effectuer des tâches administratives désignées. Par exemple, si vos opérateurs de support technique sont chargés de réinitialiser les mots de passe oubliés, d’aider les utilisateurs à rencontrer des problèmes de connectivité et de résoudre les problèmes des paramètres d’application, vous devrez peut-être combiner des paramètres de délégation sur des objets utilisateur dans Active Directory avec des privilèges qui permettent aux utilisateurs du support technique de se connecter à distance aux ordinateurs des utilisateurs pour afficher ou modifier les Pour chaque rôle que vous définissez, vous devez identifier les éléments suivants :  

1. Les tâches que les membres du rôle effectuent au quotidien et les tâches qui sont moins fréquentes.  
2. Sur quels systèmes et dans quelles applications les membres d’un rôle doivent disposer de droits et d’autorisations.  
3. Les utilisateurs qui doivent être membres d’un rôle.  
4. Comment la gestion des appartenances aux rôles sera effectuée.  

Dans de nombreux environnements, la création manuelle de contrôles d’accès basés sur les rôles pour l’administration d’un environnement de Active Directory peut être difficile à implémenter et à gérer. Si vous avez clairement défini des rôles et des responsabilités pour l’administration de votre infrastructure informatique, vous souhaiterez peut-être tirer parti d’outils supplémentaires pour vous aider à créer un déploiement RBAC natif gérable. Par exemple, si Forefront Identity Manager (FIM) est utilisé dans votre environnement, vous pouvez utiliser FIM pour automatiser la création et le remplissage des rôles d’administration, ce qui peut faciliter l’administration continue. Si vous utilisez les Configuration Manager de point de terminaison Microsoft et System Center Operations Manager (SCOM), vous pouvez utiliser des rôles spécifiques à l’application pour déléguer des fonctions de gestion et de surveillance, ainsi qu’appliquer une configuration et un audit cohérents entre les systèmes du domaine. Si vous avez implémenté une infrastructure à clé publique (PKI), vous pouvez émettre et exiger des cartes à puce pour le personnel informatique chargé d’administrer l’environnement. Avec la gestion des informations d’identification FIM (FIM CM), vous pouvez même combiner la gestion des rôles et des informations d’identification pour votre personnel administratif.  

Dans d’autres cas, il peut être préférable pour une organisation de déployer un logiciel RBAC tiers qui offre une fonctionnalité « prête à l’emploi ». Les solutions commerciales, prêtes à l’emploi (COTS) pour RBAC pour les répertoires et systèmes d’exploitation Active Directory, Windows et autres que Windows, sont proposées par un certain nombre de fournisseurs. Lorsque vous choisissez entre des solutions natives et des produits tiers, vous devez prendre en compte les facteurs suivants :  

1. Budget : en investissant dans le développement de RBAC à l’aide de logiciels et d’outils que vous possédez peut-être déjà, vous pouvez réduire les coûts des logiciels impliqués dans le déploiement d’une solution. Toutefois, à moins que vous n’ayez un personnel expérimenté dans la création et le déploiement de solutions RBAC natives, vous devrez peut-être impliquer des ressources de Conseil pour développer votre solution. Vous devez évaluer soigneusement les coûts anticipés pour une solution personnalisée avec les coûts de déploiement d’une solution « prête à l’emploi », en particulier si votre budget est limité.  
2. Composition de l’environnement informatique : Si votre environnement est constitué principalement de systèmes Windows, ou si vous tirez déjà parti de Active Directory pour la gestion des systèmes et comptes non-Windows, les solutions natives personnalisées peuvent fournir la solution optimale à vos besoins. Si votre infrastructure contient de nombreux systèmes qui n’exécutent pas Windows et qui ne sont pas gérés par Active Directory, vous devrez peut-être envisager des options pour la gestion des systèmes non-Windows indépendamment de l’environnement Active Directory.  
3. Modèle de privilège dans la solution : si un produit s’appuie sur le placement de ses comptes de service dans des groupes à privilèges élevés dans Active Directory et n’offre pas d’options qui ne nécessitent pas d’autorisations excessives pour le logiciel RBAC, vous n’avez pas vraiment réduit la surface d’attaque de votre Active Directory vous avez modifié la composition des groupes les plus privilégiés dans l’annuaire. À moins qu’un fournisseur d’applications ne puisse fournir des contrôles pour les comptes de service qui réduisent la probabilité que les comptes soient compromis et utilisés de manière malveillante, vous pouvez envisager d’autres options.  

### <a name="privileged-identity-management"></a>Privileged Identity Management

Privileged Identity Management (PIM), parfois appelé Privileged Account Management (PAM) ou Privileged Credential Management (PCM), est la conception, la construction et l’implémentation des approches de gestion des comptes privilégiés dans votre infrastructure. En règle générale, PIM fournit des mécanismes par lesquels les comptes disposent de droits temporaires et d’autorisations nécessaires pour exécuter des fonctions de correction de génération ou d’arrêt, plutôt que de laisser des privilèges attachés de façon permanente aux comptes. Si la fonctionnalité PIM est créée manuellement ou si elle est implémentée par le biais du déploiement d’un logiciel tiers, une ou plusieurs des fonctionnalités suivantes peuvent être disponibles :  
  
- Les « coffres » d’informations d’identification, où les mots de passe des comptes privilégiés sont « extraits » et auxquels un mot de passe initial a été attribué, puis « archivés » lorsque les activités sont terminées et que les mots de passe sont à nouveau réinitialisés sur les comptes.  
- Restrictions liées à la durée d’utilisation des informations d’identification privilégiées  
- Informations d’identification à usage unique  
- Octroi de privilèges générés par Workflow avec surveillance et création de rapports sur les activités effectuées et la suppression automatique des privilèges lorsque les activités sont terminées ou que le temps alloué a expiré  
- Remplacement des informations d’identification codées en dur telles que les noms d’utilisateur et les mots de passe dans les scripts avec les interfaces de programmation d’applications (API) qui permettent d’extraire les informations d’identification des coffres en fonction des besoins  
- Gestion automatique des informations d’identification du compte de service  

### <a name="creating-unprivileged-accounts-to-manage-privileged-accounts"></a>Création de comptes non privilégiés pour gérer les comptes privilégiés

L’une des difficultés liées à la gestion des comptes privilégiés est que, par défaut, les comptes qui peuvent gérer des comptes et des groupes privilégiés et protégés sont des comptes privilégiés et protégés. Si vous implémentez des solutions RBAC et PIM appropriées pour votre installation Active Directory, les solutions peuvent inclure des approches qui vous permettent de remplir efficacement l’appartenance des groupes les plus privilégiés dans l’annuaire, en remplissant les groupes uniquement de manière temporaire et si nécessaire.  

Toutefois, si vous implémentez RBAC et PIM natifs, vous devez envisager de créer des comptes qui n’ont pas de privilège et avec la seule fonction de remplissage et de remplissage des groupes privilégiés dans Active Directory si nécessaire. [L’annexe I : création de comptes de gestion pour les comptes et les groupes protégés dans Active Directory](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md) fournit des instructions pas à pas que vous pouvez utiliser pour créer des comptes à cet effet.  

### <a name="implementing-robust-authentication-controls"></a>Implémentation de contrôles d’authentification robustes

*Numéro de loi six : il y a vraiment quelqu’un qui tente de deviner vos mots de passe.* - [10 lois immuables de l’administration de la sécurité](https://technet.microsoft.com/library/cc722488.aspx)  

Les attaques Pass-The-hash et autres vols d’informations d’identification ne sont pas spécifiques aux systèmes d’exploitation Windows, et ne sont pas les nouvelles. La première attaque Pass-The-hash a été créée dans 1997. Historiquement, toutefois, ces attaques nécessitaient des outils personnalisés, pouvaient faire face à leur succès, et les attaquants devaient avoir un degré de compétence relativement élevé. L’introduction d’outils librement disponibles et faciles à utiliser qui extrait en mode natif les informations d’identification a entraîné une augmentation exponentielle du nombre et de la réussite des attaques de vol d’informations d’identification au cours des dernières années. Toutefois, les attaques par vol d’informations d’identification ne sont en aucun cas les seuls mécanismes par lesquels les informations d’identification sont ciblées et compromises.  

Bien que vous devez implémenter des contrôles pour vous protéger contre les attaques par usurpation d’identité, vous devez également identifier les comptes dans votre environnement qui sont le plus susceptibles d’être ciblés par les attaquants et implémenter des contrôles d’authentification robustes pour ces comptes. Si vos comptes les plus privilégiés utilisent une authentification à facteur unique, comme les noms d’utilisateur et les mots de passe (les deux sont « un élément que vous connaissez », qui est un facteur d’authentification), ces comptes sont protégés de manière faible. Tout ce dont a besoin une personne malveillante est de connaître le nom d’utilisateur et la connaissance du mot de passe associé au compte, et les attaques Pass-The-hash ne sont pas nécessaires pour que l’attaquant puisse s’authentifier en tant qu’utilisateur sur tout système qui accepte les informations d’identification à facteur unique.  

Bien que l’implémentation de Multi-Factor Authentication ne vous protège pas contre les attaques Pass-The-hash, l’implémentation de l’authentification multifacteur en association avec les systèmes protégés peut. Des informations supplémentaires sur l’implémentation de systèmes protégés sont fournies dans [implémentation d’ordinateurs hôtes d’administration sécurisés](../../../ad-ds/plan/security-best-practices/Implementing-Secure-Administrative-Hosts.md), et les options d’authentification sont présentées dans les sections suivantes.  

#### <a name="general-authentication-controls"></a>Contrôles d’authentification généraux

Si vous n’avez pas encore implémenté l’authentification multifacteur comme les cartes à puce, pensez à le faire. Les cartes à puce implémentent une protection matérielle des clés privées dans une paire de clés publique-privée, ce qui empêche l’accès à la clé privée d’un utilisateur ou son utilisation, sauf si l’utilisateur présente le code confidentiel, le code secret ou l’identificateur biométrique approprié à la carte à puce. Même si le code PIN ou le code secret d’un utilisateur est intercepté par un enregistreur de frappe sur un ordinateur compromis, pour qu’un attaquant puisse réutiliser le code confidentiel ou le code secret, la carte doit également être physiquement présente.

Dans les cas où les mots de passe longs et complexes ont prouvé qu’ils sont difficiles à implémenter en raison de la résistance des utilisateurs, les cartes à puce fournissent un mécanisme permettant aux utilisateurs d’implémenter des codes confidentiels relativement simples, sans que les informations d’identification ne soient sensibles aux attaques par force brute ou les tables arc-en-ciel. Les codes confidentiels de carte à puce ne sont pas stockés dans Active Directory ni dans les bases de données SAM locales, bien que les hachages d’informations d’identification puissent toujours être stockés dans la mémoire protégée par LSASS sur les ordinateurs sur lesquels des cartes à puce ont été utilisées pour l’authentification.  

#### <a name="additional-controls-for-vip-accounts"></a>Contrôles supplémentaires pour les comptes VIP

La mise en œuvre d’une carte à puce ou d’autres mécanismes d’authentification basés sur des certificats présente l’avantage de pouvoir tirer parti de l’assurance du mécanisme d’authentification pour protéger les données sensibles accessibles aux utilisateurs d’adresses IP virtuelles. L’assurance du mécanisme d’authentification est disponible dans les domaines où le niveau fonctionnel est défini sur Windows Server 2012 ou Windows Server 2008 R2. Lorsqu’il est activé, l’assurance du mécanisme d’authentification ajoute une appartenance au groupe global désignée par un administrateur au jeton Kerberos d’un utilisateur lorsque les informations d’identification de l’utilisateur sont authentifiées lors de l’ouverture de session à l’aide d’une méthode de connexion basée sur un certificat.  

Cela permet aux administrateurs de ressources de contrôler l’accès aux ressources, telles que les fichiers, les dossiers et les imprimantes, selon que l’utilisateur se connecte à l’aide d’une méthode de connexion basée sur un certificat, en plus du type de certificat utilisé. Par exemple, lorsqu’un utilisateur ouvre une session à l’aide d’une carte à puce, l’accès de l’utilisateur aux ressources sur le réseau peut être spécifié comme différent de l’accès lorsque l’utilisateur n’utilise pas de carte à puce (autrement dit, lorsque l’utilisateur ouvre une session en entrant un nom d’utilisateur et un mot de passe). Pour plus d’informations sur l’assurance du mécanisme d’authentification, consultez le [Guide pas à pas de l’assurance du mécanisme d’authentification pour AD DS dans Windows Server 2008 R2](https://technet.microsoft.com/library/dd378897.aspx).  

#### <a name="configuring-privileged-account-authentication"></a>Configuration de l’authentification par compte privilégié

Dans Active Directory pour tous les comptes d’administration, activez l’attribut **exiger une carte à puce pour une ouverture de session interactive** et auditez les modifications apportées au minimum à l’un des attributs de l’onglet **compte** pour le compte (par exemple, CN, nom, sAMAccountName, userPrincipalName et userAccountControl).  

Bien que la définition de l’option **exiger une carte à puce pour une ouverture de session interactive** réinitialise le mot de passe du compte sur une valeur aléatoire de 120 caractères et nécessite des cartes à puce pour les ouvertures de session interactives, l’attribut peut toujours être remplacé par des utilisateurs disposant d’autorisations leur permettant de modifier les mots de passe des comptes, et les comptes peuvent être utilisés pour établir des  

Dans d’autres cas, en fonction de la configuration des comptes dans Active Directory et des paramètres Active Directory de certificat dans les services de certificats (AD CS) ou d’une infrastructure à clé publique tierce, les attributs UPN (user principal name) pour les comptes d’administration ou VIP peuvent être ciblés pour un type spécifique d’attaque, comme décrit ici.  

##### <a name="upn-hijacking-for-certificate-spoofing"></a>Détournement UPN pour l’usurpation de certificat

Bien qu’une présentation approfondie des attaques sur les infrastructures à clé publique (PKI) n’est pas abordée dans ce document, les attaques contre les infrastructures à clé publique publiques et privées ont augmenté de façon exponentielle depuis 2008. Les violations des PKI publiques ont été largement répandues, mais les attaques contre l’infrastructure à clé publique interne d’une organisation sont peut-être encore plus prolifique. Une telle attaque s’appuie sur des Active Directory et des certificats pour permettre à une personne malveillante de falsifier les informations d’identification d’autres comptes d’une manière qui peut être difficile à détecter.  

Lorsqu’un certificat est présenté pour l’authentification auprès d’un système joint à un domaine, le contenu de l’objet ou l’attribut de l’autre nom de l’objet dans le certificat est utilisé pour mapper le certificat à un objet utilisateur dans Active Directory. En fonction du type de certificat et de la façon dont il est construit, l’attribut subject dans un certificat contient généralement le nom commun (CN) d’un utilisateur, comme illustré dans la capture d’écran suivante.  

![modèles d’administration des privilèges minimum](media/Implementing-Least-Privilege-Administrative-Models/SAD_4.gif)  

Par défaut, Active Directory construit le nom commun de l’utilisateur en concaténant le prénom du compte + «» + nom. Toutefois, les composants CN des objets utilisateur de Active Directory ne sont pas nécessaires ou sont uniques, et le déplacement d’un compte d’utilisateur vers un emplacement différent dans l’annuaire modifie le nom unique du compte (DN), qui est le chemin d’accès complet à l’objet dans le répertoire, comme indiqué dans le volet inférieur de la capture d’écran précédente.  

Étant donné qu’il n’est pas garanti que les noms d’objet du certificat soient statiques ou uniques, le contenu de l’autre nom de l’objet est souvent utilisé pour localiser l’objet utilisateur dans Active Directory. L’attribut SAN pour les certificats émis aux utilisateurs à partir d’autorités de certification d’entreprise (Active Directory autorités de certification intégrées) contient généralement l’adresse UPN ou l’adresse de messagerie de l’utilisateur. Étant donné que les UPN sont uniques dans une forêt AD DS, la localisation d’un objet utilisateur par UPN est couramment effectuée dans le cadre de l’authentification, avec ou sans certificats impliqués dans le processus d’authentification.  

L’utilisation d’UPN dans des attributs SAN dans des certificats d’authentification peut être exploitée par des personnes malveillantes pour obtenir des certificats frauduleux. Si une personne malveillante a compromis un compte ayant la capacité de lire et d’écrire des UPN sur des objets utilisateur, l’attaque est implémentée comme suit :  

L’attribut UPN sur un objet utilisateur (par exemple, un utilisateur VIP) est modifié temporairement en une autre valeur. L’attribut de nom de compte SAM et CN peut également être modifié pour l’instant, bien que cela ne soit généralement pas nécessaire pour les raisons décrites précédemment.  

Lorsque l’attribut UPN du compte cible a été modifié, un compte d’utilisateur obsolète, ou un compte d’utilisateur qui a été créé récemment, est remplacé par la valeur qui a été affectée à l’origine au compte cible. Les comptes d’utilisateurs obsolètes sont des comptes qui ne se sont pas connectés depuis de longues périodes, mais qui n’ont pas été désactivés. Ils sont ciblés par des attaquants qui veulent « masquer en clair » pour les raisons suivantes :  

1. Étant donné que le compte est activé mais n’a pas été utilisé récemment, il est peu probable que le compte déclenche des alertes en activant un compte d’utilisateur désactivé.  
2. L’utilisation d’un compte existant ne nécessite pas la création d’un nouveau compte d’utilisateur qui peut être remarqué par le personnel administratif.  
3. Les comptes d’utilisateurs obsolètes toujours activés sont généralement des membres de différents groupes de sécurité et bénéficient d’un accès aux ressources sur le réseau, ce qui simplifie l’accès et le « mélange » à une population d’utilisateurs existante.  

Le compte d’utilisateur sur lequel l’UPN cible a été configuré est utilisé pour demander un ou plusieurs certificats auprès de Active Directory Services de certificats.  

Lorsque des certificats ont été obtenus pour le compte de l’attaquant, les valeurs d’origine des UPN du compte « nouveau » et du compte cible sont retournées.  

L’attaquant dispose désormais d’un ou plusieurs certificats qui peuvent être présentés pour l’authentification auprès des ressources et des applications comme si l’utilisateur était l’utilisateur VIP dont le compte a été modifié temporairement. Bien qu’une description complète de toutes les façons dont les certificats et l’infrastructure à clé publique peuvent être ciblés par les attaquants n’entre pas dans le cadre de ce document, ce mécanisme d’attaque est fourni pour illustrer la raison pour laquelle vous devez surveiller les comptes privilégiés et d’adresses IP virtuelles dans AD DS pour les modifications, en particulier pour les modifications apportées à l’un des attributs de l’onglet **compte** du compte (par exemple, CN, nom, sAMAccountName, userPrincipalName et userAccountControl). En plus de surveiller les comptes, vous devez limiter au maximum les personnes autorisées à modifier les comptes pour un ensemble d’utilisateurs administratifs aussi petit que possible. De même, les comptes des utilisateurs administratifs doivent être protégés et surveillés pour les modifications non autorisées.  
