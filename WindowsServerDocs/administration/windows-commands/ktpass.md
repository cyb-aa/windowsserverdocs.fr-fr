---
title: ktpass
description: Rubrique relative aux commandes Windows pour * * * *-
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 47087676-311e-41f1-8414-199740d01444
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: de74d04ceaca0147b4d12cd9c0eaacbf233e2fd7
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/08/2020
ms.locfileid: "80841212"
---
# <a name="ktpass"></a>ktpass

>S’applique à : Windows Server (canal semi-annuel), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Configure le nom principal du serveur pour l’hôte ou le service dans les services de domaine Active Directory (AD DS) et génère un fichier. keytab qui contient la clé secrète partagée du service. Ce fichier .keytab est basé sur l’implémentation par le MIT (Massachusetts Institute of Technology) du protocole d’authentification Kerberos. L’outil en ligne de commande Ktpass permet aux services non Windows qui prennent en charge l’authentification Kerberos d’utiliser les fonctionnalités d’interopérabilité fournies par le service de centre de distribution de clés Kerberos. Cette rubrique s’applique aux versions de système d’exploitation indiquées dans la liste **s’applique à** au début de la rubrique.  

## <a name="syntax"></a>Syntaxe  
```  
ktpass  
[/out <FileName>]   
[/princ <PrincipalName>]   
[/mapuser <UserAccount>]   
[/mapop {add|set}] [{-|+}desonly] [/in <FileName>]  
[/pass {Password|*|{-|+}rndpass}]  
[/minpass]  
[/maxpass]  
[/crypto {DES-CBC-CRC|DES-CBC-MD5|RC4-HMAC-NT|AES256-SHA1|AES128-SHA1|All}]  
[/itercount]  
[/ptype {KRB5_NT_PRINCIPAL|KRB5_NT_SRV_INST|KRB5_NT_SRV_HST}]  
[/kvno <KeyversionNum>]  
[/answer {-|+}]  
[/target]  
[/rawsalt] [{-|+}dumpsalt] [{-|+}setupn] [{-|+}setpass <Password>]  [/?|/h|/help]  
```  
### <a name="parameters"></a>Paramètres  

|                                             Paramètre                                              |                                                                                                                                                                                                                                                                                                      Description                                                                                                                                                                                                                                                                                                       |
|----------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                          <FileName>/out                                           |                                                                                                                                                                        Spécifie le nom du fichier. keytab Kerberos version 5 à générer. **Remarque :** Il s’agit du fichier. keytab que vous transférez sur un ordinateur qui n’exécute pas le système d’exploitation Windows, puis remplacez ou fusionnez avec votre fichier. keytab existant,/Etc/Krb5.keytab.                                                                                                                                                                        |
|                                       /princ <PrincipalName>                                       |                                                                                                                                                                                                                   Spécifie le nom du principal sous la forme host/computer.contoso.com@CONTOSO.COM. **Avertissement :** Ce paramètre respecte la casse. Pour plus d’informations, consultez la [section Notes](#BKMK_remarks) .                                                                                                                                                                                                                    |
|                                       /mapuser <UserAccount>                                       |                                                                                                                                                                                                                                                Mappe le nom du principal Kerberos, qui est spécifié par le paramètre **princ** , au compte de domaine spécifié.                                                                                                                                                                                                                                                |
|                                       /mapop {Add&#124;Set}                                        |                                                                                                                                                                             Spécifie la manière dont l’attribut de mappage est défini.<p>-   **Ajouter** ajoute la valeur du nom d’utilisateur local spécifié. Il s’agit de l’option par défaut.<br />-   **jeu** définit la valeur du chiffrement des (Data Encryption Standard) uniquement pour le nom d’utilisateur local spécifié.                                                                                                                                                                             |
|                                         {-&#124;+} desonly                                          |                                                                                                                                                            Le chiffrement DES uniquement est défini par défaut.<p>-    **+** définit un compte pour le chiffrement des uniquement.<br />-    **-** la restriction des versions sur un compte pour le chiffrement des uniquement. **Important :** À compter de Windows 7 et de Windows Server 2008 R2, Windows ne prend pas en charge par défaut DES.                                                                                                                                                            |
|                                           /in <FileName>                                           |                                                                                                                                                                                                                                                       Spécifie le fichier. keytab à lire à partir d’un ordinateur hôte qui n’exécute pas le système d’exploitation Windows.                                                                                                                                                                                                                                                        |
|                          /Pass {mot_de_passe&#124;\*&#124;{-&#124;+} rndpass}                           |                                                                                                                                                                                                                                           Spécifie un mot de passe pour le nom d’utilisateur principal spécifié par le paramètre **princ** . Utilisez \* pour demander un mot de passe.                                                                                                                                                                                                                                            |
|                                              /minpass                                              |                                                                                                                                                                                                                                                                            Définit la longueur minimale du mot de passe aléatoire à 15 caractères.                                                                                                                                                                                                                                                                            |
|                                              /maxpass                                              |                                                                                                                                                                                                                                                                           Définit la longueur maximale du mot de passe aléatoire sur 256 caractères.                                                                                                                                                                                                                                                                            |
| /Crypto {DES-CBC-CRC&#124;des-CBC-MD5&#124;RC4-HMAC-NT&#124;AES256-SHA1&#124;AES128-SHA1&#124;tout} | Spécifie les clés qui sont générées dans le fichier keytab :<p>-   **des-CBC-CRC** est utilisé pour la compatibilité.<br />-   **des-CBC-MD5** adhère plus étroitement à l’implémentation du MIT et est utilisé pour la compatibilité.<br />-   **RC4-HMAC-NT** utilise le chiffrement 128 bits.<br />-   **AES256-SHA1** utilise le chiffrement Aes256-CTS-HMAC-SHA1-96.<br />-   **AES128-SHA1** utilise le chiffrement AES128-CTS-HMAC-SHA1-96.<br />-   **tous les** États qui peuvent être utilisés par tous les types de chiffrement pris en charge. **Remarque :** Les paramètres par défaut sont basés sur les versions ultérieures du MIT. Par conséquent, `/crypto` doit toujours être spécifié. |
|                                             /itercount                                             |                                                                                                                                                                                                                        Spécifie le nombre d’itérations utilisé pour le chiffrement AES. La valeur par défaut est que **itercount** est ignoré pour le chiffrement non AES et défini à 4 096 pour le chiffrement AES.                                                                                                                                                                                                                         |
|               /PTYPE {KRB5_NT_PRINCIPAL&#124;KRB5_NT_SRV_INST&#124;KRB5_NT_SRV_HST}                |                                                                                                                                                                                         Spécifie le type de principal.<p>-   **KRB5_NT_PRINCIPAL** est le type de principal général (recommandé).<br />-   **KRB5_NT_SRV_INST** est l’instance de service utilisateur.<br />-   **KRB5_NT_SRV_HST** est l’instance du service hôte.                                                                                                                                                                                         |
|                                       /KVNO <KeyversionNum>                                        |                                                                                                                                                                                                                                                                               Spécifie le numéro de version de la clé. La valeur par défaut est 1.                                                                                                                                                                                                                                                                                |
|                                         /Answer {-&#124;+}                                         |                                                                                                                                                                                                                    Définit le mode de réponse en arrière-plan :<p>**-** Les réponses réinitialisent automatiquement les invites de mot de passe sans.<p>**+** Les réponses réinitialisent automatiquement les invites de mot de passe avec la valeur Oui.                                                                                                                                                                                                                     |
|                                              /target                                               |                                                                                                                                                                                           Définit le contrôleur de domaine à utiliser. La valeur par défaut est pour la détection du contrôleur de domaine, en fonction du nom du principal. Si le nom du contrôleur de domaine ne peut pas être résolu, une boîte de dialogue vous invite à entrer un contrôleur de domaine valide.                                                                                                                                                                                           |
|                                              /rawsalt                                              |                                                                                                                                                                                                                                                           Force Ktpass à utiliser l’algorithme rawsalt lors de la génération de la clé. Ce paramètre n’est pas nécessaire.                                                                                                                                                                                                                                                            |
|                                         {-&#124;+} dumpsalt                                         |                                                                                                                                                                                                                                                           La sortie de ce paramètre indique l’algorithme de sel MIT utilisé pour générer la clé.                                                                                                                                                                                                                                                            |
|                                          {-&#124;+} installation                                          |                                                                                                                                                                                                                                          Définit le nom d’utilisateur principal (UPN) en plus du nom de principal du service (SPN). La valeur par défaut consiste à définir à la fois dans le fichier. keytab.                                                                                                                                                                                                                                           |
|                                    {-&#124;+} setpass <Password>                                    |                                                                                                                                                                                                                                                          Définit le mot de passe de l’utilisateur lorsqu’il est fourni. Si rndpass est utilisé, un mot de passe aléatoire est généré à la place.                                                                                                                                                                                                                                                           |
|                                       /? &#124;/h&#124;/Help                                        |                                                                                                                                                                                                                                                                                         Affiche l’aide de la ligne de commande pour ktpass.                                                                                                                                                                                                                                                                                         |

## <a name="remarks"></a><a name=BKMK_remarks></a>concernant  
Les services qui s’exécutent sur des systèmes qui n’exécutent pas le système d’exploitation Windows peuvent être configurés avec des comptes d’instance de service dans les services de domaine Active Directory. Cela permet à n’importe quel client Kerberos de s’authentifier auprès des services qui n’exécutent pas le système d’exploitation Windows à l’aide des KDC Windows.  
Le paramètre/princ n’est pas évalué par Ktpass et est utilisé comme fourni. Il n’y a aucune vérification pour déterminer si le paramètre correspond exactement à la casse de la valeur de l’attribut **userPrincipalName** lors de la génération du fichier keytab. Les distributions Kerberos sensibles à la casse utilisant ce fichier keytab peuvent rencontrer des problèmes lorsqu’il n’existe aucune correspondance de casse exacte et peuvent échouer lors de la pré-authentification. Vérifiez et récupérez la valeur d’attribut **userPrincipalName** correcte à partir d’un fichier d’exportation LDifDE. Par exemple :  
```  
ldifde /f keytab_user.ldf /d CN=Keytab User,OU=UserAccounts,DC=contoso,DC=corp,DC=microsoft,DC=com /p base /l samaccountname,userprincipalname  
```  
## <a name="examples"></a><a name=BKMK_examples></a>Illustre  
L’exemple suivant montre comment créer un fichier. keytab Kerberos, machine. keytab, dans le répertoire actif pour l’utilisateur sample1. (Vous allez fusionner ce fichier avec le fichier krb5. keytab sur un ordinateur hôte qui n’exécute pas le système d’exploitation Windows.) Le fichier Kerberos. keytab sera créé pour tous les types de chiffrement pris en charge pour le type de principal général.  
Pour générer un fichier. keytab pour un ordinateur hôte qui n’exécute pas le système d’exploitation Windows, procédez comme suit pour mapper le principal au compte et définir le mot de passe du principal de l’hôte :  
1.  Utilisez le composant logiciel enfichable utilisateurs et ordinateurs Active Directory pour créer un compte d’utilisateur pour un service sur un ordinateur qui n’exécute pas le système d’exploitation Windows. Par exemple, créez un compte avec le nom sample1.  
2.  Utilisez Ktpass pour configurer un mappage d’identité pour le compte d’utilisateur en tapant ce qui suit à l’invite de commandes :  
    ```  
    ktpass /princ host/Sample1.contoso.com@CONTOSO.COM /mapuser Sample1 /pass MyPas$w0rd /out Sample1.keytab /crypto all /ptype KRB5_NT_PRINCIPAL /mapop set   
    ```  

    > [!NOTE]  
    > Vous ne pouvez pas mapper plusieurs instances de service au même compte d’utilisateur.  

3.  Fusionnez le fichier. keytab avec le fichier/Etc/Krb5.keytab sur un ordinateur hôte qui n’exécute pas le système d’exploitation Windows. 

## <a name="additional-references"></a>Références supplémentaires  
- [Clé de syntaxe de ligne de commande](command-line-syntax-key.md)  
